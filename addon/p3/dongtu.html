<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>H·ªçc ƒê·ªông T·ª´ Ti·∫øng Nh·∫≠t & Th·ªÉ „Å¶</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'M PLUS Rounded 1c', sans-serif;
            background-color: #f3f4f6;
        }
        .main-nav-btn.active {
            background-color: #3b82f6;
            color: white;
        }
        .sub-nav-link.active {
            background-color: #dbeafe;
            color: #1d4ed8;
            font-weight: bold;
        }
        .verb-grid-item {
            transition: all 0.2s ease-in-out;
        }
        .verb-grid-item.selected {
            transform: scale(1.05);
            background-color: #60a5fa;
            color: white;
            border-color: #2563eb;
        }
        .feedback-correct {
            background-color: #dcfce7;
            border-left-color: #22c55e;
        }
        .feedback-incorrect {
            background-color: #fee2e2;
            border-left-color: #ef4444;
        }
        .dropdown-menu {
            visibility: hidden;
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.2s ease-in-out;
        }
        .group:hover .dropdown-menu {
            visibility: visible;
            opacity: 1;
            transform: translateY(0);
        }
        /* Accordion Styles */
        .accordion-header .accordion-icon {
            transition: transform 0.3s ease-in-out;
        }
        .accordion-header.open .accordion-icon {
            transform: rotate(180deg);
        }
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease-in-out;
            background-color: white;
        }
    </style>
</head>
<body class="text-gray-800">

    <div class="container mx-auto p-4 md:p-6 max-w-5xl">
        <header class="text-center mb-6">
            <h1 class="text-3xl md:text-5xl font-bold text-blue-600">Luy·ªán Si√™u Tr√≠ Nh·ªõ ƒê·ªông T·ª´</h1>
            <p class="text-gray-500 mt-2 text-lg">H·ªçc ti·∫øng Nh·∫≠t hi·ªáu qu·∫£ v√† tr·ª±c quan</p>
        </header>

        <!-- New Hierarchical Navigation -->
        <nav class="flex justify-center items-center space-x-2 md:space-x-4 mb-8 bg-white p-2 rounded-xl shadow-md sticky top-2 z-20">
            <!-- Home Button -->
            <a href="index.html" class="p-2 rounded-md hover:bg-gray-200 transition" aria-label="Trang ch·ªß">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                </svg>
            </a>
            <!-- L√Ω Thuy·∫øt Dropdown -->
            <div class="relative group">
                <button id="main-nav-theory" class="main-nav-btn flex items-center space-x-2 w-full text-left px-4 py-2 text-lg font-semibold rounded-md hover:bg-blue-100 transition"><span>L√Ω thuy·∫øt</span></button>
                <div class="dropdown-menu absolute z-10 bg-white shadow-lg rounded-md mt-1 w-48 py-1">
                    <a href="#" id="sub-nav-theory-groups" onclick="showTab('theory-groups', this, event)" class="sub-nav-link block px-4 py-2 text-gray-700 hover:bg-gray-100">Chia Nh√≥m</a>
                    <a href="#" onclick="showTab('theory-te', this, event)" class="sub-nav-link block px-4 py-2 text-gray-700 hover:bg-gray-100">Chia Th·ªÉ „Å¶</a>
                </div>
            </div>
            <!-- Tr√≤ ch∆°i Dropdown -->
            <div class="relative group">
                <button id="main-nav-game" class="main-nav-btn flex items-center space-x-2 w-full text-left px-4 py-2 text-lg font-semibold rounded-md hover:bg-blue-100 transition"><span>Tr√≤ ch∆°i</span></button>
                <div class="dropdown-menu absolute z-10 bg-white shadow-lg rounded-md mt-1 w-48 py-1">
                    <a href="#" onclick="showTab('game-irregular', this, event)" class="sub-nav-link block px-4 py-2 text-gray-700 hover:bg-gray-100">T√¨m Nh√≥m 2 ƒêB</a>
                    <a href="#" onclick="showTab('game-groups', this, event)" class="sub-nav-link block px-4 py-2 text-gray-700 hover:bg-gray-100">Ph√¢n Lo·∫°i Nh√≥m</a>
                    <a href="#" onclick="showTab('game-te', this, event)" class="sub-nav-link block px-4 py-2 text-gray-700 hover:bg-gray-100">Chia Th·ªÉ „Å¶</a>
                </div>
            </div>
            <!-- Ph·∫£n x·∫° Dropdown -->
            <div class="relative group">
                <button id="main-nav-reflex" class="main-nav-btn flex items-center space-x-2 w-full text-left px-4 py-2 text-lg font-semibold rounded-md hover:bg-blue-100 transition"><span>Ph·∫£n x·∫°</span></button>
                <div class="dropdown-menu absolute z-10 bg-white shadow-lg rounded-md mt-1 w-48 py-1">
                    <a href="#" onclick="showTab('game-reflex', this, event)" class="sub-nav-link block px-4 py-2 text-gray-700 hover:bg-gray-100">Luy·ªán Nghe</a>
                </div>
            </div>
        </nav>

        <main id="main-content">
            <!-- Theory: Verb Groups -->
            <div id="theory-groups" class="tab-content bg-white p-6 rounded-xl shadow-lg">
                <h2 class="text-2xl md:text-3xl font-bold mb-6 text-blue-700">L√Ω Thuy·∫øt: 3 Nh√≥m ƒê·ªông T·ª´ & C√°c Tr∆∞·ªùng H·ª£p ƒê·∫∑c Bi·ªát</h2>
                <div class="space-y-4 accordion-container">
                    <!-- Accordion Item 1 -->
                    <div class="accordion-item border rounded-lg overflow-hidden">
                        <button class="accordion-header w-full flex justify-between items-center p-4 bg-green-100 hover:bg-green-200 transition">
                            <span class="font-bold text-xl text-green-800">Nh√≥m 3 (B·∫•t quy t·∫Øc)</span>
                            <svg class="accordion-icon w-6 h-6 text-green-800" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                        </button>
                        <div class="accordion-content">
                            <div class="p-4">
                                <p><strong class="font-semibold">C√¥ng th·ª©c:</strong> Nh√≥m n√†y ch·ªâ bao g·ªìm 2 ƒë·ªông t·ª´ g·ªëc v√† c√°c bi·∫øn th·ªÉ c·ªßa „Åó„Åæ„Åô.</p>
                                <ul class="list-disc list-inside mt-2 pl-4 space-y-1">
                                    <li><code class="bg-gray-200 px-2 py-1 rounded">„Åó„Åæ„Åô</code> (l√†m) v√† c√°c ƒë·ªông t·ª´ c√≥ c·∫•u tr√∫c "Danh t·ª´ + „Åó„Åæ„Åô".</li>
                                    <li><code class="bg-gray-200 px-2 py-1 rounded">Êù•„Åæ„Åô („Åç„Åæ„Åô)</code> (ƒë·∫øn).</li>
                                </ul>
                                <p class="mt-2"><strong class="font-semibold text-red-500">Ch√∫ √Ω:</strong> Nh√≥m n√†y kh√¥ng c√≥ ngo·∫°i l·ªá. Ch·ªâ c·∫ßn nh·ªõ hai tr∆∞·ªùng h·ª£p n√†y l√† ƒë·ªß.</p>
                            </div>
                        </div>
                    </div>
                    <!-- Accordion Item 2 -->
                    <div class="accordion-item border rounded-lg overflow-hidden">
                        <button class="accordion-header w-full flex justify-between items-center p-4 bg-yellow-100 hover:bg-yellow-200 transition">
                            <span class="font-bold text-xl text-yellow-800">Nh√≥m 2 (Ichidan)</span>
                            <svg class="accordion-icon w-6 h-6 text-yellow-800" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                        </button>
                        <div class="accordion-content">
                             <div class="p-4">
                                <p><strong class="font-semibold">C√¥ng th·ª©c ch√≠nh:</strong> Nh·ªØng ƒë·ªông t·ª´ c√≥ √¢m ti·∫øt ngay tr∆∞·ªõc <code class="bg-gray-200 px-2 py-1 rounded">„Åæ„Åô</code> thu·ªôc <strong>h√†ng „Åà (e)</strong>.</p>
                                <p class="mt-4"><strong class="font-semibold text-red-500">Ch√∫ √Ω v·ªÅ ngo·∫°i l·ªá:</strong> ƒê√¢y l√† nh√≥m c√≥ nhi·ªÅu ngo·∫°i l·ªá c·∫ßn ghi nh·ªõ nh·∫•t. C√°c ƒë·ªông t·ª´ n√†y d√π c√≥ √¢m tr∆∞·ªõc <code class="bg-gray-200 px-2 py-1 rounded">„Åæ„Åô</code> thu·ªôc <strong>h√†ng „ÅÑ (i)</strong> nh∆∞ng v·∫´n ƒë∆∞·ª£c x·∫øp v√†o Nh√≥m 2.</p>
                                <p class="mt-4"><strong>Danh s√°ch c√°c ƒë·ªông t·ª´ ngo·∫°i l·ªá Nh√≥m 2 th∆∞·ªùng g·∫∑p:</strong></p>
                                <div class="grid grid-cols-1 sm:grid-cols-2 gap-x-8 gap-y-2 mt-2 bg-yellow-50 p-4 rounded-md">
                                    <div class="flex justify-between border-b border-yellow-200 py-1"><code class="font-semibold text-yellow-900">„Åä„Åç„Åæ„Åô</code><span>Th·ª©c d·∫≠y</span></div>
                                    <div class="flex justify-between border-b border-yellow-200 py-1"><code class="font-semibold text-yellow-900">„Åä„Çä„Åæ„Åô</code><span>Xu·ªëng (xe)</span></div>
                                    <div class="flex justify-between border-b border-yellow-200 py-1"><code class="font-semibold text-yellow-900">„ÅÇ„Å≥„Åæ„Åô</code><span>T·∫Øm</span></div>
                                    <div class="flex justify-between border-b border-yellow-200 py-1"><code class="font-semibold text-yellow-900">„Åç„Åæ„Åô</code><span>M·∫∑c</span></div>
                                    <div class="flex justify-between border-b border-yellow-200 py-1"><code class="font-semibold text-yellow-900">„Åä„Å°„Åæ„Åô</code><span>R∆°i, r·ª•ng</span></div>
                                    <div class="flex justify-between border-b border-yellow-200 py-1"><code class="font-semibold text-yellow-900">„ÅÑ„Åæ„Åô</code><span>·ªû, c√≥</span></div>
                                    <div class="flex justify-between border-b border-yellow-200 py-1"><code class="font-semibold text-yellow-900">„Åã„Çä„Åæ„Åô</code><span>M∆∞·ª£n</span></div>
                                    <div class="flex justify-between border-b border-yellow-200 py-1"><code class="font-semibold text-yellow-900">„Åß„Åç„Åæ„Åô</code><span>C√≥ th·ªÉ</span></div>
                                    <div class="flex justify-between border-b border-yellow-200 py-1"><code class="font-semibold text-yellow-900">„Åø„Åæ„Åô</code><span>Nh√¨n, xem</span></div>
                                    <div class="flex justify-between border-b border-yellow-200 py-1"><code class="font-semibold text-yellow-900">„Åü„Çä„Åæ„Åô</code><span>ƒê·ªß</span></div>
                                </div>
                                <div class="mt-6 p-4 bg-green-100 border-l-4 border-green-400 rounded">
                                    <h4 class="font-bold text-lg text-green-800">üí° B√†i Th∆° M·∫πo Nh·ªõ Ngo·∫°i L·ªá Nh√≥m 2</h4>
                                    <p class="mt-2 italic leading-relaxed text-green-900">
                                        S√°ng s·ªõm <strong>th·ª©c d·∫≠y</strong> (<code class="text-sm bg-green-200 px-1 rounded">„Åä„Åç„Åæ„Åô</code>),<br>
                                        <strong>Xu·ªëng</strong> (<code class="text-sm bg-green-200 px-1 rounded">„Åä„Çä„Åæ„Åô</code>) gi∆∞·ªùng ƒëi <strong>t·∫Øm</strong> (<code class="text-sm bg-green-200 px-1 rounded">„ÅÇ„Å≥„Åæ„Åô</code>).<br>
                                        <strong>M·∫∑c</strong> (<code class="text-sm bg-green-200 px-1 rounded">„Åç„Åæ„Åô</code>) qu·∫ßn √°o th√¨ ti·ªÅn <strong>r∆°i</strong> (<code class="text-sm bg-green-200 px-1 rounded">„Åä„Å°„Åæ„Åô</code>) ra,<br>
                                        <strong>C√≥</strong> (<code class="text-sm bg-green-200 px-1 rounded">„ÅÑ„Åæ„Åô</code>) b·∫°n ƒë·∫øn ch∆°i,<br>
                                        Li·ªÅn <strong>m∆∞·ª£n</strong> (<code class="text-sm bg-green-200 px-1 rounded">„Åã„Çä„Åæ„Åô</code>) b·∫°n ti·ªÅn,<br>
                                        ƒê·ªÉ <strong>c√≥ th·ªÉ</strong> (<code class="text-sm bg-green-200 px-1 rounded">„Åß„Åç„Åæ„Åô</code>) <strong>ƒë·ªß</strong> (<code class="text-sm bg-green-200 px-1 rounded">„Åü„Çä„Åæ„Åô</code>) 2 v√© ƒëi <strong>xem</strong> (<code class="text-sm bg-green-200 px-1 rounded">„Åø„Åæ„Åô</code>) phim.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                     <!-- Accordion Item 3 -->
                    <div class="accordion-item border rounded-lg overflow-hidden">
                        <button class="accordion-header w-full flex justify-between items-center p-4 bg-purple-100 hover:bg-purple-200 transition">
                            <span class="font-bold text-xl text-purple-800">Nh√≥m 1 (Godan)</span>
                            <svg class="accordion-icon w-6 h-6 text-purple-800" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                        </button>
                        <div class="accordion-content">
                            <div class="p-4">
                                <p><strong class="font-semibold">C√¥ng th·ª©c:</strong> Bao g·ªìm t·∫•t c·∫£ c√°c ƒë·ªông t·ª´ c√≤n l·∫°i. H·∫ßu h·∫øt c√°c ƒë·ªông t·ª´ n√†y c√≥ √¢m ti·∫øt tr∆∞·ªõc <code class="bg-gray-200 px-2 py-1 rounded">„Åæ„Åô</code> thu·ªôc <strong>h√†ng „ÅÑ (i)</strong>.</p>
                                 <p class="mt-4"><strong class="font-semibold text-red-500">Ch√∫ √Ω v·ªÅ ngo·∫°i l·ªá:</strong></p>
                                <ul class="list-disc list-inside mt-2 pl-4 space-y-2">
                                    <li>Ngo·∫°i l·ªá quan tr·ªçng nh·∫•t l√† ph·∫£i <strong>lo·∫°i tr·ª´</strong> danh s√°ch c√°c ƒë·ªông t·ª´ ƒë·∫∑c bi·ªát c·ªßa Nh√≥m 2 ƒë√£ n√™u ·ªü tr√™n.</li>
                                    <li>M·ªôt s·ªë ƒë·ªông t·ª´ tr√¥ng gi·ªëng Nh√≥m 2 (v√¨ c√≥ √¢m <code class="bg-gray-200 px-1 rounded">„Åà</code>) nh∆∞ng th·ª±c ch·∫•t l·∫°i l√† Nh√≥m 1: <br><code class="bg-purple-100 text-purple-800 p-1 rounded">Â∏∞„Çä„Åæ„Åô („Åã„Åà„Çä„Åæ„Åô)</code>, <code class="bg-purple-100 text-purple-800 p-1 rounded">ÂÖ•„Çä„Åæ„Åô („ÅØ„ÅÑ„Çä„Åæ„Åô)</code>, <code class="bg-purple-100 text-purple-800 p-1 rounded">Áü•„Çä„Åæ„Åô („Åó„Çä„Åæ„Åô)</code>, <code class="bg-purple-100 text-purple-800 p-1 rounded">Âàá„Çä„Åæ„Åô („Åç„Çä„Åæ„Åô)</code>.</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Theory: Te Form -->
            <div id="theory-te" class="tab-content bg-white p-6 rounded-xl shadow-lg hidden">
                 <h2 class="text-2xl md:text-3xl font-bold mb-6 text-blue-700">L√Ω Thuy·∫øt: Chinh Ph·ª•c Th·ªÉ „Å¶</h2>
                 <div class="space-y-4 accordion-container">
                    <!-- Accordion Item 1 -->
                    <div class="accordion-item border rounded-lg overflow-hidden">
                        <button class="accordion-header w-full flex justify-between items-center p-4 bg-green-100 hover:bg-green-200 transition">
                            <span class="font-bold text-xl text-green-800">Nh√≥m 2 & 3 (D·ªÖ nh·∫•t)</span>
                            <svg class="accordion-icon w-6 h-6 text-green-800" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                        </button>
                        <div class="accordion-content">
                            <div class="p-4">
                                <p><strong class="font-semibold">C√¥ng th·ª©c:</strong> B·ªè <code class="bg-gray-200 px-2 py-1 rounded">„Åæ„Åô</code> th√™m <code class="bg-green-200 px-2 py-1 rounded">„Å¶</code>.</p>
                                <ul class="list-disc list-inside mt-2 pl-4 space-y-1">
                                    <li>Nh√≥m 2: <code class="bg-gray-200 px-1 rounded">È£ü„Åπ„Åæ„Åô</code> ‚Üí <code class="bg-green-100 px-1 rounded">È£ü„Åπ„Å¶</code></li>
                                    <li>Nh√≥m 3: <code class="bg-gray-200 px-1 rounded">ÂãâÂº∑„Åó„Åæ„Åô</code> ‚Üí <code class="bg-green-100 px-1 rounded">ÂãâÂº∑„Åó„Å¶</code></li>
                                    <li>Ngo·∫°i l·ªá Nh√≥m 3: <code class="bg-gray-200 px-1 rounded">Êù•„Åæ„Åô („Åç„Åæ„Åô)</code> ‚Üí <code class="bg-green-100 px-1 rounded">Êù•„Å¶ („Åç„Å¶)</code></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <!-- Accordion Item 2 -->
                    <div class="accordion-item border rounded-lg overflow-hidden">
                        <button class="accordion-header w-full flex justify-between items-center p-4 bg-purple-100 hover:bg-purple-200 transition">
                            <span class="font-bold text-xl text-purple-800">Nh√≥m 1 (Th·ª≠ th√°ch)</span>
                            <svg class="accordion-icon w-6 h-6 text-purple-800" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                        </button>
                        <div class="accordion-content">
                            <div class="p-4">
                                <p>Quy t·∫Øc chia ph·ª• thu·ªôc v√†o √¢m ti·∫øt cu·ªëi c√πng ƒë·ª©ng tr∆∞·ªõc <code class="bg-gray-200 px-2 py-1 rounded">„Åæ„Åô</code>.</p>
                                <div class="overflow-x-auto mt-4">
                                    <table class="w-full text-left border-collapse">
                                        <thead class="bg-purple-100">
                                            <tr>
                                                <th class="p-3 font-bold uppercase text-purple-800 border border-purple-200">√Çm ti·∫øt tr∆∞·ªõc „Åæ„Åô</th>
                                                <th class="p-3 font-bold uppercase text-purple-800 border border-purple-200">Chuy·ªÉn th√†nh</th>
                                                <th class="p-3 font-bold uppercase text-purple-800 border border-purple-200">V√≠ d·ª•</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr class="hover:bg-gray-50">
                                                <td class="p-3 border border-purple-200 font-mono">„ÅÑ„Éª„Å°„Éª„Çä</td>
                                                <td class="p-3 border border-purple-200 font-mono text-red-600 font-bold">„Å£„Å¶</td>
                                                <td class="p-3 border border-purple-200">‰ºö„ÅÑ„Åæ„Åô ‚Üí ‰ºö„Å£„Å¶</td>
                                            </tr>
                                            <tr class="hover:bg-gray-50">
                                                <td class="p-3 border border-purple-200 font-mono">„Å´„Éª„Å≥„Éª„Åø</td>
                                                <td class="p-3 border border-purple-200 font-mono text-red-600 font-bold">„Çì„Åß</td>
                                                <td class="p-3 border border-purple-200">È£≤„Åø„Åæ„Åô ‚Üí È£≤„Çì„Åß</td>
                                            </tr>
                                            <tr class="hover:bg-gray-50">
                                                <td class="p-3 border border-purple-200 font-mono">„Åç</td>
                                                <td class="p-3 border border-purple-200 font-mono text-red-600 font-bold">„ÅÑ„Å¶</td>
                                                <td class="p-3 border border-purple-200">Êõ∏„Åç„Åæ„Åô ‚Üí Êõ∏„ÅÑ„Å¶</td>
                                            </tr>
                                             <tr class="hover:bg-gray-50">
                                                <td class="p-3 border border-purple-200 font-mono">„Åé</td>
                                                <td class="p-3 border border-purple-200 font-mono text-red-600 font-bold">„ÅÑ„Åß</td>
                                                <td class="p-3 border border-purple-200">Ê≥≥„Åé„Åæ„Åô ‚Üí Ê≥≥„ÅÑ„Åß</td>
                                            </tr>
                                            <tr class="hover:bg-gray-50">
                                                <td class="p-3 border border-purple-200 font-mono">„Åó</td>
                                                <td class="p-3 border border-purple-200 font-mono text-red-600 font-bold">„Åó„Å¶</td>
                                                <td class="p-3 border border-purple-200">Ë©±„Åó„Åæ„Åô ‚Üí Ë©±„Åó„Å¶</td>
                                            </tr>
                                            <tr class="bg-red-50 hover:bg-red-100">
                                                <td class="p-3 border border-purple-200 font-mono font-bold">ƒê·∫∑c bi·ªát: Ë°å„Åç„Åæ„Åô</td>
                                                <td class="p-3 border border-purple-200 font-mono text-red-600 font-bold">„ÅÑ„Å£„Å¶</td>
                                                <td class="p-3 border border-purple-200">Ë°å„Åç„Åæ„Åô ‚Üí Ë°å„Å£„Å¶</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <div class="mt-6 p-4 bg-yellow-100 border-l-4 border-yellow-400 rounded">
                                    <h4 class="font-bold text-lg text-yellow-800">üéµ B√†i H√°t M·∫πo Nh·ªõ</h4>
                                    <p class="mt-2 italic">
                                        I, chi, ri ‚Üí <strong class="text-red-600">tte</strong>, Ni, bi, mi ‚Üí <strong class="text-red-600">n de</strong>,<br>
                                        Ki ‚Üí <strong class="text-red-600">ite</strong>, Gi ‚Üí <strong class="text-red-600">ide</strong>.<br>
                                        Ikimasu ‚Üí <strong class="text-red-600">itte</strong>, Ikimasu ‚Üí <strong class="text-red-600">itte</strong>,<br>
                                        Shi, shi ‚Üí <strong class="text-red-600">te</strong>, Shi, shi ‚Üí <strong class="text-red-600">te</strong>.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Game: Irregular Verbs -->
            <div id="game-irregular" class="tab-content bg-white p-6 rounded-xl shadow-lg hidden">
                <h2 class="text-2xl md:text-3xl font-bold mb-2 text-center">Game: SƒÉn L√πng ƒê·ªông T·ª´ Nh√≥m 2 ƒê·∫∑c Bi·ªát</h2>
                <p class="text-center text-gray-600 mb-6">H√£y ch·ªçn t·∫•t c·∫£ c√°c ƒë·ªông t·ª´ Nh√≥m 2 c√≥ k·∫øt th√∫c l√† h√†ng <strong>„ÅÑ</strong> (i) nh√©!</p>
                <div id="irregular-verb-grid" class="grid grid-cols-2 sm:grid-cols-4 md:grid-cols-5 gap-4">
                    <!-- Verbs will be injected here by JS -->
                </div>
                <div class="text-center mt-8 flex justify-center items-center gap-4">
                    <button id="check-irregular-btn" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-8 rounded-lg transition shadow-lg hover:scale-105">Ki·ªÉm tra</button>
                    <button id="reset-irregular-btn" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-8 rounded-lg transition shadow-lg hover:scale-105">Ch∆°i l·∫°i</button>
                </div>
                <div id="irregular-feedback" class="mt-6 text-center font-semibold text-lg"></div>
            </div>

            <!-- Game: Group Classification -->
            <div id="game-groups" class="tab-content bg-white p-6 rounded-xl shadow-lg hidden">
                <h2 class="text-2xl md:text-3xl font-bold mb-6 text-center">Game: ƒê·ªông T·ª´ N√†y Thu·ªôc Nh√≥m N√†o?</h2>
                <div id="group-game-container" class="text-center">
                    <div id="group-question-card" class="bg-blue-50 p-6 rounded-lg min-h-[150px] flex flex-col justify-center">
                        <p class="text-lg mb-2">ƒê·ªông t·ª´:</p>
                        <p id="group-question-verb" class="text-4xl font-bold text-blue-800 mb-1"></p>
                        <p id="group-question-meaning" class="text-gray-600 text-xl"></p>
                    </div>
                    <div id="group-answers" class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-6">
                        <!-- Answer buttons will be injected here -->
                    </div>
                    <div id="group-feedback" class="mt-6 p-4 rounded-lg border-l-4 hidden"></div>
                    <button id="group-next-btn" class="hidden mt-4 bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-8 rounded-lg transition hover:scale-105">C√¢u ti·∫øp theo</button>
                </div>
                 <div class="text-center mt-6">
                    <button onclick="startGroupGame()" class="bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-3 px-8 rounded-lg transition shadow-lg hover:scale-105">B·∫Øt ƒë·∫ßu / Ch∆°i l·∫°i</button>
                </div>
            </div>

            <!-- Game: Te Form Conjugation -->
            <div id="game-te" class="tab-content bg-white p-6 rounded-xl shadow-lg hidden">
                <h2 class="text-2xl md:text-3xl font-bold mb-6 text-center">Game: Chia Th·ªÉ „Å¶</h2>
                <div id="te-game-container" class="text-center">
                    <div id="te-question-card" class="bg-yellow-50 p-6 rounded-lg min-h-[150px] flex flex-col justify-center">
                        <p class="text-lg mb-2">Th·ªÉ „Å¶ c·ªßa ƒë·ªông t·ª´ sau l√† g√¨?</p>
                        <p id="te-question-verb" class="text-4xl font-bold text-yellow-800"></p>
                    </div>
                    <div id="te-answers" class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-6">
                        <!-- Answer buttons will be injected here -->
                    </div>
                    <div id="te-feedback" class="mt-6 p-4 rounded-lg border-l-4 hidden"></div>
                    <button id="te-next-btn" class="hidden mt-4 bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-8 rounded-lg transition hover:scale-105">C√¢u ti·∫øp theo</button>
                </div>
                 <div class="text-center mt-6">
                    <button onclick="startTeGame()" class="bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-3 px-8 rounded-lg transition shadow-lg hover:scale-105">B·∫Øt ƒë·∫ßu / Ch∆°i l·∫°i</button>
                </div>
            </div>

            <!-- Game: Listening Reflex -->
            <div id="game-reflex" class="tab-content bg-white p-6 rounded-xl shadow-lg hidden">
                 <h2 class="text-2xl md:text-3xl font-bold mb-6 text-center">Game: Luy·ªán Ph·∫£n X·∫° Nghe</h2>
                 <div id="reflex-game-container" class="text-center">
                    <div class="min-h-[250px] flex flex-col items-center justify-center bg-gray-50 rounded-lg p-6">
                        <div id="reflex-start-view">
                             <p class="mb-4 text-gray-600">Nh·∫•n n√∫t b√™n d∆∞·ªõi ƒë·ªÉ nghe ƒë·ªông t·ª´ v√† luy·ªán ph·∫£n x·∫° trong 5 gi√¢y.</p>
                             <button id="reflex-start-btn" class="bg-red-500 hover:bg-red-600 text-white font-bold py-4 px-10 rounded-full transition shadow-xl text-lg hover:scale-105">B·∫ÆT ƒê·∫¶U</button>
                        </div>
                        <div id="reflex-playing-view" class="hidden">
                            <p class="text-2xl text-gray-700 mb-4">L·∫Øng nghe v√† suy nghƒ©...</p>
                            <div id="reflex-timer" class="text-6xl font-bold text-red-500">5</div>
                        </div>
                        <div id="reflex-result-view" class="hidden text-center">
                             <p class="text-2xl font-bold text-gray-800 mb-2" id="reflex-result-verb"></p>
                             <p class="text-5xl font-bold text-green-600" id="reflex-result-te"></p>
                             <button id="reflex-next-btn" class="mt-6 bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-8 rounded-lg transition hover:scale-105">Ti·∫øp t·ª•c</button>
                        </div>
                    </div>
                 </div>
            </div>

        </main>
    </div>

    <script>
        // --- DATABASE ---
        const verbs = [
            // Data from PDF, classified
            { id: 1, kanji: 'Ë°å„Åç„Åæ„Åô', hiragana: '„ÅÑ„Åç„Åæ„Åô', meaning: 'ƒêi', group: 1, reason: 'ƒê√¢y l√† ƒë·ªông t·ª´ ƒë·∫∑c bi·ªát c·ªßa nh√≥m 1 khi chia th·ªÉ „Å¶.', te_form: '„ÅÑ„Å£„Å¶', is_irregular_g2: false, is_irregular_g1: true },
            { id: 2, kanji: 'ÂØù„Åæ„Åô', hiragana: '„Å≠„Åæ„Åô', meaning: 'Ng·ªß', group: 2, reason: '√Çm ti·∫øt tr∆∞·ªõc „Åæ„Åô l√† „Å≠ (ne) thu·ªôc c·ªôt „Åà (e).', te_form: '„Å≠„Å¶', is_irregular_g2: false, is_irregular_g1: false },
            { id: 3, kanji: 'ÂÉç„Åç„Åæ„Åô', hiragana: '„ÅØ„Åü„Çâ„Åç„Åæ„Åô', meaning: 'L√†m vi·ªác', group: 1, reason: '√Çm ti·∫øt tr∆∞·ªõc „Åæ„Åô l√† „Åç (ki) thu·ªôc c·ªôt „ÅÑ (i).', te_form: '„ÅØ„Åü„Çâ„ÅÑ„Å¶', is_irregular_g2: false, is_irregular_g1: false },
            { id: 4, kanji: 'ÁµÇ„Çè„Çä„Åæ„Åô', hiragana: '„Åä„Çè„Çä„Åæ„Åô', meaning: 'K·∫øt th√∫c', group: 1, reason: '√Çm ti·∫øt tr∆∞·ªõc „Åæ„Åô l√† „Çä (ri) thu·ªôc c·ªôt „ÅÑ (i).', te_form: '„Åä„Çè„Å£„Å¶', is_irregular_g2: false, is_irregular_g1: false },
            { id: 5, kanji: 'ÂãâÂº∑„Åó„Åæ„Åô', hiragana: '„Åπ„Çì„Åç„Çá„ÅÜ„Åó„Åæ„Åô', meaning: 'H·ªçc', group: 3, reason: 'K·∫øt th√∫c b·∫±ng „Åó„Åæ„Åô (shimasu).', te_form: '„Åπ„Çì„Åç„Çá„ÅÜ„Åó„Å¶', is_irregular_g2: false, is_irregular_g1: false },
            { id: 6, kanji: '„Åó„Åæ„Åô', hiragana: '„Åó„Åæ„Åô', meaning: 'L√†m', group: 3, reason: 'ƒê√¢y l√† ƒë·ªông t·ª´ g·ªëc c·ªßa nh√≥m 3.', te_form: '„Åó„Å¶', is_irregular_g2: false, is_irregular_g1: false },
            { id: 7, kanji: 'Ëµ∑„Åç„Åæ„Åô', hiragana: '„Åä„Åç„Åæ„Åô', meaning: 'Th·ª©c d·∫≠y', group: 2, reason: 'ƒê√¢y l√† ƒë·ªông t·ª´ ƒë·∫∑c bi·ªát c·ªßa nh√≥m 2. D√π √¢m tr∆∞·ªõc „Åæ„Åô l√† „Åç (ki), n√≥ v·∫´n thu·ªôc nh√≥m 2.', te_form: '„Åä„Åç„Å¶', is_irregular_g2: true, is_irregular_g1: false },
            { id: 8, kanji: 'Êù•„Åæ„Åô', hiragana: '„Åç„Åæ„Åô', meaning: 'ƒê·∫øn', group: 3, reason: 'ƒê√¢y l√† ƒë·ªông t·ª´ b·∫•t quy t·∫Øc g·ªëc c·ªßa nh√≥m 3.', te_form: '„Åç„Å¶', is_irregular_g2: false, is_irregular_g1: false },
            { id: 9, kanji: 'Â∏∞„Çä„Åæ„Åô', hiragana: '„Åã„Åà„Çä„Åæ„Åô', meaning: 'V·ªÅ', group: 1, reason: 'ƒê√¢y l√† ƒë·ªông t·ª´ ƒë·∫∑c bi·ªát c·ªßa nh√≥m 1. D√π c√≥ √¢m „Åà (e), n√≥ v·∫´n thu·ªôc nh√≥m 1.', te_form: '„Åã„Åà„Å£„Å¶', is_irregular_g2: false, is_irregular_g1: true },
            { id: 10, kanji: 'È£ü„Åπ„Åæ„Åô', hiragana: '„Åü„Åπ„Åæ„Åô', meaning: 'ƒÇn', group: 2, reason: '√Çm ti·∫øt tr∆∞·ªõc „Åæ„Åô l√† „Åπ (be) thu·ªôc c·ªôt „Åà (e).', te_form: '„Åü„Åπ„Å¶', is_irregular_g2: false, is_irregular_g1: false },
            { id: 11, kanji: 'È£≤„Åø„Åæ„Åô', hiragana: '„ÅÆ„Åø„Åæ„Åô', meaning: 'U·ªëng', group: 1, reason: '√Çm ti·∫øt tr∆∞·ªõc „Åæ„Åô l√† „Åø (mi) thu·ªôc c·ªôt „ÅÑ (i).', te_form: '„ÅÆ„Çì„Åß', is_irregular_g2: false, is_irregular_g1: false },
            { id: 12, kanji: 'Ë¶ã„Åæ„Åô', hiragana: '„Åø„Åæ„Åô', meaning: 'Nh√¨n, xem', group: 2, reason: 'ƒê√¢y l√† ƒë·ªông t·ª´ ƒë·∫∑c bi·ªát c·ªßa nh√≥m 2. D√π √¢m tr∆∞·ªõc „Åæ„Åô l√† „Åø (mi), n√≥ v·∫´n thu·ªôc nh√≥m 2.', te_form: '„Åø„Å¶', is_irregular_g2: true, is_irregular_g1: false },
            { id: 13, kanji: 'ËÅû„Åç„Åæ„Åô', hiragana: '„Åç„Åç„Åæ„Åô', meaning: 'Nghe', group: 1, reason: '√Çm ti·∫øt tr∆∞·ªõc „Åæ„Åô l√† „Åç (ki) thu·ªôc c·ªôt „ÅÑ (i).', te_form: '„Åç„ÅÑ„Å¶', is_irregular_g2: false, is_irregular_g1: false },
            { id: 14, kanji: 'Ë™≠„Åø„Åæ„Åô', hiragana: '„Çà„Åø„Åæ„Åô', meaning: 'ƒê·ªçc', group: 1, reason: '√Çm ti·∫øt tr∆∞·ªõc „Åæ„Åô l√† „Åø (mi) thu·ªôc c·ªôt „ÅÑ (i).', te_form: '„Çà„Çì„Åß', is_irregular_g2: false, is_irregular_g1: false },
            { id: 15, kanji: 'Êõ∏„Åç„Åæ„Åô', hiragana: '„Åã„Åç„Åæ„Åô', meaning: 'Vi·∫øt', group: 1, reason: '√Çm ti·∫øt tr∆∞·ªõc „Åæ„Åô l√† „Åç (ki) thu·ªôc c·ªôt „ÅÑ (i).', te_form: '„Åã„ÅÑ„Å¶', is_irregular_g2: false, is_irregular_g1: false },
            { id: 16, kanji: '‰ºö„ÅÑ„Åæ„Åô', hiragana: '„ÅÇ„ÅÑ„Åæ„Åô', meaning: 'G·∫∑p', group: 1, reason: '√Çm ti·∫øt tr∆∞·ªõc „Åæ„Åô l√† „ÅÑ (i) thu·ªôc c·ªôt „ÅÑ (i).', te_form: '„ÅÇ„Å£„Å¶', is_irregular_g2: false, is_irregular_g1: false },
            { id: 18, kanji: 'Âàá„Çä„Åæ„Åô', hiragana: '„Åç„Çä„Åæ„Åô', meaning: 'C·∫Øt', group: 1, reason: 'ƒê√¢y l√† ƒë·ªông t·ª´ ƒë·∫∑c bi·ªát c·ªßa nh√≥m 1. D√π c√≥ √¢m „ÅÑ (i), n√≥ thu·ªôc nh√≥m 1.', te_form: '„Åç„Å£„Å¶', is_irregular_g2: false, is_irregular_g1: true },
            { id: 23, kanji: 'Êïô„Åà„Åæ„Åô', hiragana: '„Åä„Åó„Åà„Åæ„Åô', meaning: 'D·∫°y', group: 2, reason: '√Çm ti·∫øt tr∆∞·ªõc „Åæ„Åô l√† „Åà (e) thu·ªôc c·ªôt „Åà (e).', te_form: '„Åä„Åó„Åà„Å¶', is_irregular_g2: false, is_irregular_g1: false },
            { id: 25, kanji: 'ÂÄü„Çä„Åæ„Åô', hiragana: '„Åã„Çä„Åæ„Åô', meaning: 'M∆∞·ª£n', group: 2, reason: 'ƒê√¢y l√† ƒë·ªông t·ª´ ƒë·∫∑c bi·ªát c·ªßa nh√≥m 2. D√π √¢m tr∆∞·ªõc „Åæ„Åô l√† „Çä (ri), n√≥ v·∫´n thu·ªôc nh√≥m 2.', te_form: '„Åã„Çä„Å¶', is_irregular_g2: true, is_irregular_g1: false },
            { id: 26, kanji: 'Ë≤∏„Åó„Åæ„Åô', hiragana: '„Åã„Åó„Åæ„Åô', meaning: 'Cho m∆∞·ª£n', group: 1, reason: '√Çm ti·∫øt tr∆∞·ªõc „Åæ„Åô l√† „Åó (shi) thu·ªôc c·ªôt „ÅÑ (i).', te_form: '„Åã„Åó„Å¶', is_irregular_g2: false, is_irregular_g1: false },
            { id: 37, kanji: 'Ê≥≥„Åé„Åæ„Åô', hiragana: '„Åä„Çà„Åé„Åæ„Åô', meaning: 'B∆°i', group: 1, reason: '√Çm ti·∫øt tr∆∞·ªõc „Åæ„Åô l√† „Åé (gi) thu·ªôc c·ªôt „ÅÑ (i).', te_form: '„Åä„Çà„ÅÑ„Åß', is_irregular_g2: false, is_irregular_g1: false },
            { id: 44, kanji: 'ÊÄ•„Åé„Åæ„Åô', hiragana: '„ÅÑ„Åù„Åé„Åæ„Åô', meaning: 'V·ªôi', group: 1, reason: '√Çm ti·∫øt tr∆∞·ªõc „Åæ„Åô l√† „Åé (gi) thu·ªôc c·ªôt „ÅÑ (i).', te_form: '„ÅÑ„Åù„ÅÑ„Åß', is_irregular_g2: false, is_irregular_g1: false },
            { id: 45, kanji: 'ÂæÖ„Å°„Åæ„Åô', hiragana: '„Åæ„Å°„Åæ„Åô', meaning: 'ƒê·ª£i', group: 1, reason: '√Çm ti·∫øt tr∆∞·ªõc „Åæ„Åô l√† „Å° (chi) thu·ªôc c·ªôt „ÅÑ (i).', te_form: '„Åæ„Å£„Å¶', is_irregular_g2: false, is_irregular_g1: false },
            { id: 48, kanji: 'Âëº„Å≥„Åæ„Åô', hiragana: '„Çà„Å≥„Åæ„Åô', meaning: 'G·ªçi', group: 1, reason: '√Çm ti·∫øt tr∆∞·ªõc „Åæ„Åô l√† „Å≥ (bi) thu·ªôc c·ªôt „ÅÑ (i).', te_form: '„Çà„Çì„Åß', is_irregular_g2: false, is_irregular_g1: false },
            { id: 49, kanji: 'Ë©±„Åó„Åæ„Åô', hiragana: '„ÅØ„Å™„Åó„Åæ„Åô', meaning: 'N√≥i chuy·ªán', group: 1, reason: '√Çm ti·∫øt tr∆∞·ªõc „Åæ„Åô l√† „Åó (shi) thu·ªôc c·ªôt „ÅÑ (i).', te_form: '„ÅØ„Å™„Åó„Å¶', is_irregular_g2: false, is_irregular_g1: false },
            { id: 54, kanji: 'ÂÖ•„Çä„Åæ„Åô', hiragana: '„ÅØ„ÅÑ„Çä„Åæ„Åô', meaning: 'V√†o', group: 1, reason: 'ƒê√¢y l√† ƒë·ªông t·ª´ ƒë·∫∑c bi·ªát c·ªßa nh√≥m 1. D√π c√≥ √¢m „ÅÑ (i), n√≥ v·∫´n thu·ªôc nh√≥m 1.', te_form: '„ÅØ„ÅÑ„Å£„Å¶', is_irregular_g2: false, is_irregular_g1: true },
            { id: 64, kanji: 'Èôç„Çä„Åæ„Åô', hiragana: '„Åä„Çä„Åæ„Åô', meaning: 'Xu·ªëng (xe)', group: 2, reason: 'ƒê√¢y l√† ƒë·ªông t·ª´ ƒë·∫∑c bi·ªát c·ªßa nh√≥m 2. D√π √¢m tr∆∞·ªõc „Åæ„Åô l√† „Çä (ri), n√≥ v·∫´n thu·ªôc nh√≥m 2.', te_form: '„Åä„Çä„Å¶', is_irregular_g2: true, is_irregular_g1: false },
            { id: 88, kanji: 'Âá∫Êù•„Åæ„Åô', hiragana: '„Åß„Åç„Åæ„Åô', meaning: 'C√≥ th·ªÉ', group: 2, reason: 'ƒê√¢y l√† ƒë·ªông t·ª´ ƒë·∫∑c bi·ªát c·ªßa nh√≥m 2. D√π √¢m tr∆∞·ªõc „Åæ„Åô l√† „Åç (ki), n√≥ v·∫´n thu·ªôc nh√≥m 2.', te_form: '„Åß„Åç„Å¶', is_irregular_g2: true, is_irregular_g1: false },
            { id: 99, kanji: 'Ë¶Å„Çä„Åæ„Åô', hiragana: '„ÅÑ„Çä„Åæ„Åô', meaning: 'C·∫ßn', group: 1, reason: 'ƒê√¢y l√† ƒë·ªông t·ª´ ƒë·∫∑c bi·ªát c·ªßa nh√≥m 1. D√π c√≥ √¢m „ÅÑ (i), n√≥ v·∫´n thu·ªôc nh√≥m 1.', te_form: '„ÅÑ„Å£„Å¶', is_irregular_g2: false, is_irregular_g1: true },
            { id: 130, kanji: 'Ë∂≥„Çä„Åæ„Åô', hiragana: '„Åü„Çä„Åæ„Åô', meaning: 'ƒê·ªß', group: 2, reason: 'ƒê√¢y l√† ƒë·ªông t·ª´ ƒë·∫∑c bi·ªát c·ªßa nh√≥m 2. D√π √¢m tr∆∞·ªõc „Åæ„Åô l√† „Çä (ri), n√≥ v·∫´n thu·ªôc nh√≥m 2.', te_form: '„Åü„Çä„Å¶', is_irregular_g2: true, is_irregular_g1: false },
            // From image
            { id: 131, kanji: 'Êµ¥„Å≥„Åæ„Åô', hiragana: '„ÅÇ„Å≥„Åæ„Åô', meaning: 'T·∫Øm', group: 2, reason: 'ƒê√¢y l√† ƒë·ªông t·ª´ ƒë·∫∑c bi·ªát c·ªßa nh√≥m 2. D√π √¢m tr∆∞·ªõc „Åæ„Åô l√† „Å≥ (bi), n√≥ v·∫´n thu·ªôc nh√≥m 2.', te_form: '„ÅÇ„Å≥„Å¶', is_irregular_g2: true, is_irregular_g1: false },
            { id: 132, kanji: 'ÁùÄ„Åæ„Åô', hiragana: '„Åç„Åæ„Åô', meaning: 'M·∫∑c', group: 2, reason: 'ƒê√¢y l√† ƒë·ªông t·ª´ ƒë·∫∑c bi·ªát c·ªßa nh√≥m 2. D√π √¢m tr∆∞·ªõc „Åæ„Åô l√† „Åç (ki), n√≥ v·∫´n thu·ªôc nh√≥m 2.', te_form: '„Åç„Å¶', is_irregular_g2: true, is_irregular_g1: false },
            { id: 133, kanji: 'ËêΩ„Å°„Åæ„Åô', hiragana: '„Åä„Å°„Åæ„Åô', meaning: 'R∆°i, r·ª•ng', group: 2, reason: 'ƒê√¢y l√† ƒë·ªông t·ª´ ƒë·∫∑c bi·ªát c·ªßa nh√≥m 2. D√π √¢m tr∆∞·ªõc „Åæ„Åô l√† „Å° (chi), n√≥ v·∫´n thu·ªôc nh√≥m 2.', te_form: '„Åä„Å°„Å¶', is_irregular_g2: true, is_irregular_g1: false },
            { id: 134, kanji: '„ÅÑ„Åæ„Åô', hiragana: '„ÅÑ„Åæ„Åô', meaning: '·ªû', group: 2, reason: 'ƒê√¢y l√† ƒë·ªông t·ª´ ƒë·∫∑c bi·ªát c·ªßa nh√≥m 2. D√π √¢m tr∆∞·ªõc „Åæ„Åô l√† „ÅÑ (i), n√≥ v·∫´n thu·ªôc nh√≥m 2.', te_form: '„ÅÑ„Å¶', is_irregular_g2: true, is_irregular_g1: false },
        ];

        // --- GLOBAL STATE ---
        let speech = new SpeechSynthesisUtterance();
        speech.lang = "ja-JP";
        speech.rate = 0.9;
        let isAudioUnlocked = false; // Flag to track audio unlock status for mobile

        // --- TAB MANAGEMENT ---
        function showTab(tabId, clickedElement, event) {
            if (event) {
                event.preventDefault();
            }
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.add('hidden'));
            document.getElementById(tabId).classList.remove('hidden');
            
            document.querySelectorAll('.main-nav-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.sub-nav-link').forEach(link => link.classList.remove('active'));

            if (clickedElement) {
                clickedElement.classList.add('active');
            }

            if (tabId.startsWith('theory')) {
                document.getElementById('main-nav-theory').classList.add('active');
            } else if (tabId.startsWith('game')) {
                if (tabId === 'game-reflex') {
                    document.getElementById('main-nav-reflex').classList.add('active');
                } else {
                    document.getElementById('main-nav-game').classList.add('active');
                }
            }

            if (tabId === 'game-irregular') initIrregularGame();
            if (tabId === 'game-groups') startGroupGame();
            if (tabId === 'game-te') startTeGame();
            if (tabId === 'game-reflex') initReflexGame();
        }
        
        // --- ACCORDION ---
        function initAccordions() {
            const accordionHeaders = document.querySelectorAll('.accordion-header');
            accordionHeaders.forEach(header => {
                header.addEventListener('click', () => {
                    const content = header.nextElementSibling;
                    header.classList.toggle('open');
                    if (content.style.maxHeight) {
                        content.style.maxHeight = null;
                    } else {
                        content.style.maxHeight = content.scrollHeight + "px";
                    }
                });
            });
        }
        
        // --- GAME 0: IRREGULAR VERB FINDER ---
        const irregularGameVerbsPool = [
            { hiragana: '„Åä„Åç„Åæ„Åô', isIrregular: true }, { hiragana: '„Åä„Çä„Åæ„Åô', isIrregular: true },
            { hiragana: '„ÅÇ„Å≥„Åæ„Åô', isIrregular: true }, { hiragana: '„Åç„Åæ„Åô', isIrregular: true }, // ÁùÄ„Åæ„Åô
            { hiragana: '„Åä„Å°„Åæ„Åô', isIrregular: true }, { hiragana: '„ÅÑ„Åæ„Åô', isIrregular: true },
            { hiragana: '„Åã„Çä„Åæ„Åô', isIrregular: true }, { hiragana: '„Åß„Åç„Åæ„Åô', isIrregular: true },
            { hiragana: '„Åü„Çä„Åæ„Åô', isIrregular: true }, { hiragana: '„Åø„Åæ„Åô', isIrregular: true },
            // Distractors
            { hiragana: '„Åã„Åà„Çä„Åæ„Åô', isIrregular: false }, { hiragana: '„ÅØ„Å™„Åó„Åæ„Åô', isIrregular: false },
            { hiragana: '„ÅÆ„Åø„Åæ„Åô', isIrregular: false }, { hiragana: '„Åç„Åæ„Åô', isIrregular: false }, // Êù•„Åæ„Åô
            { hiragana: '„Å§„Åè„Çä„Åæ„Åô', isIrregular: false }, { hiragana: '„ÅØ„Åü„Çâ„Åç„Åæ„Åô', isIrregular: false },
            { hiragana: '„Åä„Çè„Çä„Åæ„Åô', isIrregular: false }, { hiragana: '„Åπ„Çì„Åç„Çá„ÅÜ„Åó„Åæ„Åô', isIrregular: false },
            { hiragana: '„Å≠„Åæ„Åô', isIrregular: false }, { hiragana: '„Åç„Åç„Åæ„Åô', isIrregular: false }
        ];

        function initIrregularGame() {
            // Shuffle the pool and take 20 verbs for the game
            const gameVerbs = irregularGameVerbsPool.sort(() => 0.5 - Math.random());

            const grid = document.getElementById('irregular-verb-grid');
            const feedbackEl = document.getElementById('irregular-feedback');
            grid.innerHTML = '';
            feedbackEl.textContent = '';
            
            gameVerbs.forEach(verb => {
                const item = document.createElement('button');
                item.textContent = verb.hiragana;
                item.dataset.isIrregular = verb.isIrregular;
                // Reset classes to default state for re-playability
                item.className = 'verb-grid-item p-4 border-2 rounded-lg cursor-pointer text-xl font-bold bg-gray-100 hover:bg-blue-200';
                item.onclick = () => {
                    // Only allow selection if the game is active (not checked yet)
                    if (!grid.hasAttribute('data-checked')) {
                        item.classList.toggle('selected');
                    }
                };
                grid.appendChild(item);
            });
            // Reset checked state
            grid.removeAttribute('data-checked');
            document.getElementById('check-irregular-btn').disabled = false;
        }

        document.getElementById('check-irregular-btn').addEventListener('click', () => {
            const grid = document.getElementById('irregular-verb-grid');
            const items = grid.querySelectorAll('.verb-grid-item');
            let correctSelections = 0;
            const totalIrregulars = Array.from(items).filter(item => item.dataset.isIrregular === 'true').length;

            // Mark the grid as checked to disable further selections
            grid.setAttribute('data-checked', 'true');

            items.forEach(item => {
                const isSelected = item.classList.contains('selected');
                const isIrregular = item.dataset.isIrregular === 'true';

                // Remove selection and hover classes to apply feedback colors cleanly
                item.classList.remove('selected', 'bg-gray-100', 'hover:bg-blue-200');

                if (isSelected && isIrregular) {
                    item.classList.add('bg-green-300'); // Correctly selected
                    correctSelections++;
                } else if (isSelected && !isIrregular) {
                    item.classList.add('bg-red-300'); // Incorrectly selected
                } else if (!isSelected && isIrregular) {
                    item.classList.add('bg-yellow-300'); // Missed
                } else {
                    item.classList.add('bg-gray-100'); // Unselected and correct
                }
            });
            
            document.getElementById('irregular-feedback').textContent = `B·∫°n ƒë√£ t√¨m ƒë√∫ng ${correctSelections} / ${totalIrregulars} ƒë·ªông t·ª´. (Xanh: ƒê√∫ng, ƒê·ªè: Sai, V√†ng: B·ªè s√≥t)`;
            document.getElementById('check-irregular-btn').disabled = true;
        });
        
        document.getElementById('reset-irregular-btn').addEventListener('click', initIrregularGame);

        // --- GAME 1: GROUP CLASSIFICATION ---
        let currentGroupGameVerb = null;
        function startGroupGame() {
            currentGroupGameVerb = verbs[Math.floor(Math.random() * verbs.length)];
            document.getElementById('group-question-verb').textContent = currentGroupGameVerb.hiragana;
            document.getElementById('group-question-meaning').textContent = `(${currentGroupGameVerb.meaning})`;
            const answersContainer = document.getElementById('group-answers');
            answersContainer.innerHTML = '';
            [1, 2, 3].forEach(groupNum => {
                const button = document.createElement('button');
                button.textContent = `Nh√≥m ${groupNum}`;
                button.className = 'w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-4 px-4 rounded-lg transition text-xl transform hover:scale-105';
                button.onclick = () => checkGroupAnswer(groupNum);
                answersContainer.appendChild(button);
            });
            document.getElementById('group-feedback').classList.add('hidden');
            document.getElementById('group-next-btn').classList.add('hidden');
        }

        function checkGroupAnswer(selectedGroup) {
            const feedbackEl = document.getElementById('group-feedback');
            const isCorrect = selectedGroup === currentGroupGameVerb.group;
            if (isCorrect) {
                feedbackEl.innerHTML = `<strong class="text-green-600">Ch√≠nh x√°c!</strong> ${currentGroupGameVerb.reason}`;
                feedbackEl.className = 'mt-6 p-4 rounded-lg border-l-4 feedback-correct';
            } else {
                feedbackEl.innerHTML = `<strong class="text-red-600">Ch∆∞a ƒë√∫ng!</strong> ƒê√°p √°n ƒë√∫ng l√† <strong>Nh√≥m ${currentGroupGameVerb.group}</strong>. <br>${currentGroupGameVerb.reason}`;
                feedbackEl.className = 'mt-6 p-4 rounded-lg border-l-4 feedback-incorrect';
            }
            feedbackEl.classList.remove('hidden');
            document.getElementById('group-next-btn').classList.remove('hidden');
            document.getElementById('group-answers').innerHTML = '';
        }
        
        document.getElementById('group-next-btn').addEventListener('click', startGroupGame);

        // --- GAME 2: TE-FORM CONJUGATION ---
        let currentTeGameVerb = null;
        function startTeGame() {
            currentTeGameVerb = verbs[Math.floor(Math.random() * verbs.length)];
            document.getElementById('te-question-verb').textContent = currentTeGameVerb.hiragana;
            const answersContainer = document.getElementById('te-answers');
            answersContainer.innerHTML = '';
            let options = [...new Set([
                currentTeGameVerb.te_form,
                currentTeGameVerb.hiragana + '„Å¶',
                currentTeGameVerb.hiragana.replace(/„Åæ„Åô$/, '„Çã'),
                currentTeGameVerb.group === 1 ? currentTeGameVerb.hiragana.replace(/„Åæ„Åô$/, '„Å¶') : currentTeGameVerb.hiragana.replace(/[„ÅÑ|„Å°|„Çä]„Åæ„Åô$/, '„Å£„Å¶')
            ])].sort(() => Math.random() - 0.5);
            
            options.forEach(option => {
                const button = document.createElement('button');
                button.textContent = option;
                button.className = 'w-full bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-4 px-4 rounded-lg transition text-2xl transform hover:scale-105';
                button.onclick = () => checkTeAnswer(option);
                answersContainer.appendChild(button);
            });
            document.getElementById('te-feedback').classList.add('hidden');
            document.getElementById('te-next-btn').classList.add('hidden');
        }

        function checkTeAnswer(selectedAnswer) {
            const feedbackEl = document.getElementById('te-feedback');
            const isCorrect = selectedAnswer === currentTeGameVerb.te_form;
            if (isCorrect) {
                feedbackEl.innerHTML = `<strong class="text-green-600">Tuy·ªát v·ªùi!</strong> ${currentTeGameVerb.hiragana} (Nh√≥m ${currentTeGameVerb.group}) chia th√†nh ${currentTeGameVerb.te_form}.`;
                feedbackEl.className = 'mt-6 p-4 rounded-lg border-l-4 feedback-correct';
            } else {
                feedbackEl.innerHTML = `<strong class="text-red-600">Sai r·ªìi!</strong> ƒê√°p √°n ƒë√∫ng l√† <strong>${currentTeGameVerb.te_form}</strong>. <br>V√¨ ${currentTeGameVerb.hiragana} thu·ªôc nh√≥m ${currentTeGameVerb.group}, n√™n ta √°p d·ª•ng quy t·∫Øc chia c·ªßa nh√≥m ƒë√≥.`;
                feedbackEl.className = 'mt-6 p-4 rounded-lg border-l-4 feedback-incorrect';
            }
            feedbackEl.classList.remove('hidden');
            document.getElementById('te-next-btn').classList.remove('hidden');
            document.getElementById('te-answers').innerHTML = '';
        }

        document.getElementById('te-next-btn').addEventListener('click', startTeGame);
        
        // --- GAME 3: REFLEX ---
        let reflexTimerInterval;
        function initReflexGame() {
            document.getElementById('reflex-start-view').classList.remove('hidden');
            document.getElementById('reflex-playing-view').classList.add('hidden');
            document.getElementById('reflex-result-view').classList.add('hidden');
            clearInterval(reflexTimerInterval);
        }

        function startReflexRound() {
            // Mobile browser audio unlock. Must be in a direct user interaction event.
            if (!isAudioUnlocked) {
                const unlockSpeech = new SpeechSynthesisUtterance('');
                unlockSpeech.volume = 0; // Play silently
                window.speechSynthesis.speak(unlockSpeech);
                isAudioUnlocked = true;
            }

            document.getElementById('reflex-start-view').classList.add('hidden');
            document.getElementById('reflex-result-view').classList.add('hidden');
            document.getElementById('reflex-playing-view').classList.remove('hidden');
            
            const verb = verbs[Math.floor(Math.random() * verbs.length)];
            speech.text = verb.hiragana;
            window.speechSynthesis.speak(speech);

            let timeLeft = 5;
            const timerEl = document.getElementById('reflex-timer');
            timerEl.textContent = timeLeft;
            reflexTimerInterval = setInterval(() => {
                timeLeft--;
                timerEl.textContent = timeLeft;
                if (timeLeft <= 0) {
                    clearInterval(reflexTimerInterval);
                    showReflexResult(verb);
                }
            }, 1000);
        }

        function showReflexResult(verb) {
            document.getElementById('reflex-playing-view').classList.add('hidden');
            document.getElementById('reflex-result-view').classList.remove('hidden');
            document.getElementById('reflex-result-verb').textContent = `${verb.hiragana} (${verb.kanji})`;
            document.getElementById('reflex-result-te').textContent = verb.te_form;
        }

        document.getElementById('reflex-start-btn').addEventListener('click', startReflexRound);
        document.getElementById('reflex-next-btn').addEventListener('click', startReflexRound);

        // --- INITIALIZATION ---
        window.onload = () => {
            const initialLink = document.getElementById('sub-nav-theory-groups');
            showTab('theory-groups', initialLink);
            initAccordions();
        };
    </script>

</body>
</html>
